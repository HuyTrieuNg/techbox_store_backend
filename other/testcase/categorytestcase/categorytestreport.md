# Category Management API - Test Report

## Overview

### **Project Information**
- **API Base URL**: `http://localhost:8080/api/categories`  
- **Authentication**: JWT Bearer Token (planned for Admin operations)
- **Database**: MySQL v·ªõi hierarchical categories (parent-child relationships)
- **Framework**: Spring Boot REST API

### **API Functions Covered**
| Function | Endpoint | Method | Description |
|----------|----------|--------|-------------|
| **List Categories** | `/api/categories` | GET | L·∫•y t·∫•t c·∫£ categories |
| **Get Category by ID** | `/api/categories/{id}` | GET | L·∫•y category theo ID |
| **Get Root Categories** | `/api/categories/root` | GET | L·∫•y categories g·ªëc (parent = null) |
| **Get Child Categories** | `/api/categories/{parentId}/children` | GET | L·∫•y categories con |
| **Create Category** | `/api/categories` | POST | T·∫°o category m·ªõi |
| **Update Category** | `/api/categories/{id}` | PUT | C·∫≠p nh·∫≠t category |
| **Delete Category** | `/api/categories/{id}` | DELETE | X√≥a category |
| **Check Exists** | `/api/categories/exists` | GET | Ki·ªÉm tra t√™n category t·ªìn t·∫°i |

## Validation Rules cho Category Name

### **üîí Security & Data Integrity Rules**

| Rule | Description | Implementation | Test Cases |
|------|-------------|----------------|-------------|
| **Required** | T√™n category b·∫Øt bu·ªôc nh·∫≠p | `@NotBlank` | TC_CAT_008, 009, 009A |
| **Length** | ƒê·ªô d√†i: 2-255 k√Ω t·ª± | `@Size(min=2, max=255)` | TC_CAT_010, 010A |
| **Null/Undefined** | Kh√¥ng ƒë∆∞·ª£c null ho·∫∑c undefined | `@NotNull` validation | TC_CAT_009, 009A |
| **Whitespace** | Kh√¥ng ƒë∆∞·ª£c ch·ªâ to√†n kho·∫£ng tr·∫Øng | Custom validation | TC_CAT_011, 011A |
| **Special Characters** | Cho ph√©p: a-z, A-Z, 0-9, space, &, -, ', Unicode | Pattern validation | TC_CAT_011B, 011C |
| **Uniqueness** | T√™n category ph·∫£i duy nh·∫•t | Database constraint | TC_CAT_012 |
| **Case Insensitive** | Kh√¥ng ph√¢n bi·ªát hoa th∆∞·ªùng | Custom uniqueness check | TC_CAT_012A, 012B |
| **SQL Injection** | NgƒÉn ch·∫∑n SQL injection | Input sanitization | TC_CAT_012C |
| **XSS Protection** | NgƒÉn ch·∫∑n XSS attacks | HTML/Script filtering | TC_CAT_012D, 011C |
| **Hierarchical Rules** | Parent-child relationship validation | Business logic | TC_CAT_013A-013D |

### **‚úÖ Allowed Characters**
- **Letters**: a-z, A-Z (Latin alphabet)
- **Unicode**: √†, √°, ·∫£, √£, ·∫°, ƒÉ, ·∫±, ·∫Ø, ·∫≥, ·∫µ, ·∫∑, √¢, ·∫ß, ·∫•, ·∫©, ·∫´, ·∫≠, ƒë, √®, √©, ·∫ª, ·∫Ω, ·∫π, √™, ·ªÅ, ·∫ø, ·ªÉ, ·ªÖ, ·ªá, √¨, √≠, ·ªâ, ƒ©, ·ªã, √≤, √≥, ·ªè, √µ, ·ªç, √¥, ·ªì, ·ªë, ·ªï, ·ªó, ·ªô, ∆°, ·ªù, ·ªõ, ·ªü, ·ª°, ·ª£, √π, √∫, ·ªß, ≈©, ·ª•, ∆∞, ·ª´, ·ª©, ·ª≠, ·ªØ, ·ª±, ·ª≥, √Ω, ·ª∑, ·ªπ, ·ªµ v√† c√°c k√Ω t·ª± Unicode kh√°c
- **Numbers**: 0-9  
- **Spaces**: Single spaces (auto-trimmed)
- **Special**: & (ampersand), - (hyphen), ' (apostrophe)
- **Examples**: "Electronics", "Th·ªùi Trang", "Home & Garden", "Men's Fashion"

### **‚ùå Blocked Characters**
- **HTML Tags**: `<`, `>`, `<script>`, `<img>`
- **SQL Characters**: `'`, `"`, `;`, `--`, `/*`, `*/`  
- **Script**: `javascript:`, `vbscript:`, `onload=`, `onerror=`
- **Control**: `\n`, `\r`, `\t` (except normal space)

## Test Cases Detail

### **Function 1: L·∫•y danh s√°ch categories (GET /api/categories)**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_001 | Ki·ªÉm tra l·∫•y danh s√°ch t·∫•t c·∫£ categories th√†nh c√¥ng (Public access) | G·ª≠i GET request ƒë·∫øn "/api/categories". | - HTTP Status: 200 OK<br>- Response body:<br>[<br>  {<br>    "id": 1,<br>    "name": "Electronics",<br>    "parentCategoryId": null,<br>    "createdAt": "2025-09-30T10:00:00Z",<br>    "updatedAt": "2025-09-30T10:00:00Z"<br>  },<br>  {<br>    "id": 2,<br>    "name": "Smartphones",<br>    "parentCategoryId": 1,<br>    "createdAt": "2025-09-30T10:00:00Z",<br>    "updatedAt": "2025-09-30T10:00:00Z"<br>  }<br>] | Database c√≥ categories: Electronics (ID=1, parent=null), Smartphones (ID=2, parent=1)<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_002 | Ki·ªÉm tra l·∫•y danh s√°ch categories khi database tr·ªëng | G·ª≠i GET request ƒë·∫øn "/api/categories". | - HTTP Status: 200 OK<br>- Response body: [] | Database kh√¥ng c√≥ category n√†o<br>**Kh√¥ng c·∫ßn authentication** |

### **Function 2: L·∫•y category theo ID (GET /api/categories/{id})**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_003 | Ki·ªÉm tra l·∫•y category theo ID h·ª£p l·ªá (Public access) | G·ª≠i GET request ƒë·∫øn "/api/categories/1". | - HTTP Status: 200 OK<br>- Response body:<br>{<br>  "id": 1,<br>  "name": "Electronics",<br>  "parentCategoryId": null,<br>  "createdAt": "2025-09-30T10:00:00Z",<br>  "updatedAt": "2025-09-30T10:00:00Z"<br>} | Category Electronics v·ªõi ID=1 t·ªìn t·∫°i<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_004 | Ki·ªÉm tra l·∫•y category v·ªõi ID kh√¥ng t·ªìn t·∫°i | G·ª≠i GET request ƒë·∫øn "/api/categories/999999". | - HTTP Status: 404 Not Found<br>- Response body:<br>{<br>  "error": "Category not found",<br>  "message": "Category with ID 999999 does not exist"<br>} | ID 999999 kh√¥ng t·ªìn t·∫°i trong database<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_005 | Ki·ªÉm tra l·∫•y category v·ªõi ID kh√¥ng h·ª£p l·ªá (string) | G·ª≠i GET request ƒë·∫øn "/api/categories/abc". | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Invalid parameter",<br>  "message": "ID must be a valid integer"<br>} | **Kh√¥ng c·∫ßn authentication** |

### **Function 3: L·∫•y root categories (GET /api/categories/root)**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_006 | Ki·ªÉm tra l·∫•y root categories th√†nh c√¥ng | G·ª≠i GET request ƒë·∫øn "/api/categories/root". | - HTTP Status: 200 OK<br>- Response body:<br>[<br>  {<br>    "id": 1,<br>    "name": "Electronics",<br>    "parentCategoryId": null<br>  },<br>  {<br>    "id": 3,<br>    "name": "Fashion",<br>    "parentCategoryId": null<br>  }<br>] | Database c√≥ root categories: Electronics (ID=1), Fashion (ID=3)<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_007 | Ki·ªÉm tra l·∫•y root categories khi kh√¥ng c√≥ | G·ª≠i GET request ƒë·∫øn "/api/categories/root". | - HTTP Status: 200 OK<br>- Response body: [] | Database ch·ªâ c√≥ child categories<br>**Kh√¥ng c·∫ßn authentication** |

### **Function 4: L·∫•y child categories (GET /api/categories/{parentId}/children)**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_007A | Ki·ªÉm tra l·∫•y child categories th√†nh c√¥ng | G·ª≠i GET request ƒë·∫øn "/api/categories/1/children". | - HTTP Status: 200 OK<br>- Response body:<br>[<br>  {<br>    "id": 2,<br>    "name": "Smartphones",<br>    "parentCategoryId": 1<br>  },<br>  {<br>    "id": 4,<br>    "name": "Laptops",<br>    "parentCategoryId": 1<br>  }<br>] | Electronics (ID=1) c√≥ child categories: Smartphones (ID=2), Laptops (ID=4)<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_007B | Ki·ªÉm tra l·∫•y child categories khi parent kh√¥ng c√≥ con | G·ª≠i GET request ƒë·∫øn "/api/categories/2/children". | - HTTP Status: 200 OK<br>- Response body: [] | Smartphones (ID=2) kh√¥ng c√≥ child categories<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_007C | Ki·ªÉm tra l·∫•y child categories v·ªõi parent kh√¥ng t·ªìn t·∫°i | G·ª≠i GET request ƒë·∫øn "/api/categories/999/children". | - HTTP Status: 404 Not Found<br>- Response body:<br>{<br>  "error": "Parent category not found",<br>  "message": "Parent category with ID 999 does not exist"<br>} | ID 999 kh√¥ng t·ªìn t·∫°i<br>**Kh√¥ng c·∫ßn authentication** |

### **Function 5: T·∫°o category m·ªõi (POST /api/categories)**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_008 | Ki·ªÉm tra t·∫°o category m·ªõi th√†nh c√¥ng v·ªõi role Admin | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Gaming" } | - HTTP Status: 201 Created<br>- Response body:<br>{<br>  "id": 5,<br>  "name": "Gaming",<br>  "parentCategoryId": null,<br>  "createdAt": "2025-09-30T14:00:00Z",<br>  "updatedAt": "2025-09-30T14:00:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p (admin@techbox.com/admin123)<br>JWT token h·ª£p l·ªá v·ªõi ADMIN role<br>Category name "Gaming" ch∆∞a t·ªìn t·∫°i |
| TC_CAT_009 | Ki·ªÉm tra t·∫°o category v·ªõi t√™n tr·ªëng | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name is required",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>JWT token h·ª£p l·ªá |
| TC_CAT_009A | Ki·ªÉm tra t·∫°o category v·ªõi t√™n undefined | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name is required",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>JWT token h·ª£p l·ªá |
| TC_CAT_010 | Ki·ªÉm tra t·∫°o category v·ªõi t√™n qu√° d√†i (>255 k√Ω t·ª±) | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "A very long category name that exceeds..." } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name must not exceed 255 characters",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>JWT token h·ª£p l·ªá |
| TC_CAT_010A | Ki·ªÉm tra t·∫°o category v·ªõi t√™n qu√° ng·∫Øn (<2 k√Ω t·ª±) | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "A" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name must be at least 2 characters long",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>JWT token h·ª£p l·ªá |
| TC_CAT_011 | Ki·ªÉm tra t·∫°o category v·ªõi t√™n ch·ªâ ch·ª©a kho·∫£ng tr·∫Øng | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "   " } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name cannot contain only whitespace",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>JWT token h·ª£p l·ªá |
| TC_CAT_011A | Ki·ªÉm tra t·∫°o category v·ªõi t√™n c√≥ kho·∫£ng tr·∫Øng ƒë·∫ßu/cu·ªëi | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "  Books  " } | - HTTP Status: 201 Created<br>- Response body:<br>{<br>  "id": 6,<br>  "name": "Books",<br>  "parentCategoryId": null,<br>  "createdAt": "2025-09-30T14:00:00Z",<br>  "updatedAt": "2025-09-30T14:00:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>H·ªá th·ªëng t·ª± ƒë·ªông trim kho·∫£ng tr·∫Øng |
| TC_CAT_011B | Ki·ªÉm tra t·∫°o category v·ªõi k√Ω t·ª± ƒë·∫∑c bi·ªát h·ª£p l·ªá | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Home & Garden" } | - HTTP Status: 201 Created<br>- Response body:<br>{<br>  "id": 7,<br>  "name": "Home & Garden",<br>  "parentCategoryId": null,<br>  "createdAt": "2025-09-30T14:00:00Z",<br>  "updatedAt": "2025-09-30T14:00:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>K√Ω t·ª± &, space h·ª£p l·ªá |
| TC_CAT_011C | Ki·ªÉm tra t·∫°o category v·ªõi k√Ω t·ª± ƒë·∫∑c bi·ªát kh√¥ng h·ª£p l·ªá | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Category<script>alert('xss')</script>" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name contains invalid characters",<br>  "field": "name",<br>  "invalidChars": ["<", ">"]<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>NgƒÉn ch·∫∑n XSS attack |
| TC_CAT_012 | Ki·ªÉm tra t·∫°o category v·ªõi t√™n tr√πng l·∫∑p | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Electronics" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Duplicate entry",<br>  "message": "Category name 'Electronics' already exists",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Category "Electronics" ƒë√£ t·ªìn t·∫°i (ID=1) |
| TC_CAT_012A | Ki·ªÉm tra t·∫°o category v·ªõi t√™n tr√πng l·∫∑p (case insensitive) | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "ELECTRONICS" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Duplicate entry",<br>  "message": "Category name 'ELECTRONICS' already exists (case insensitive)",<br>  "field": "name",<br>  "existingCategory": "Electronics"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Category "Electronics" ƒë√£ t·ªìn t·∫°i<br>Case insensitive check |
| TC_CAT_012B | Ki·ªÉm tra SQL Injection trong t√™n category | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "'; DROP TABLE categories; --" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name contains potentially dangerous characters",<br>  "field": "name",<br>  "securityViolation": "SQL_INJECTION_ATTEMPT"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>NgƒÉn ch·∫∑n SQL injection |
| TC_CAT_012C | Ki·ªÉm tra XSS trong t√™n category | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "<img src='x' onerror='alert(1)'>" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Validation failed",<br>  "message": "Category name contains potentially dangerous HTML/Script content",<br>  "field": "name",<br>  "securityViolation": "XSS_ATTEMPT"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>NgƒÉn ch·∫∑n XSS attack |
| TC_CAT_012D | Ki·ªÉm tra Unicode trong t√™n category | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Th·ªùi Trang" } | - HTTP Status: 201 Created<br>- Response body:<br>{<br>  "id": 8,<br>  "name": "Th·ªùi Trang",<br>  "parentCategoryId": null,<br>  "createdAt": "2025-09-30T14:00:00Z",<br>  "updatedAt": "2025-09-30T14:00:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Unicode characters ƒë∆∞·ª£c h·ªó tr·ª£ |
| TC_CAT_013 | Ki·ªÉm tra t·∫°o child category th√†nh c√¥ng | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Smartphones", "parentCategoryId": 1 } | - HTTP Status: 201 Created<br>- Response body:<br>{<br>  "id": 9,<br>  "name": "Smartphones",<br>  "parentCategoryId": 1,<br>  "createdAt": "2025-09-30T14:00:00Z",<br>  "updatedAt": "2025-09-30T14:00:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Parent category Electronics (ID=1) t·ªìn t·∫°i |
| TC_CAT_013A | Ki·ªÉm tra t·∫°o category v·ªõi parent kh√¥ng t·ªìn t·∫°i | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Invalid Child", "parentCategoryId": 999 } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Invalid parent category",<br>  "message": "Parent category with ID 999 does not exist",<br>  "field": "parentCategoryId"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Parent ID 999 kh√¥ng t·ªìn t·∫°i |
| TC_CAT_013B | Ki·ªÉm tra t·∫°o category v·ªõi parent = ch√≠nh n√≥ (circular reference) | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Self Parent", "parentCategoryId": 10 } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Invalid hierarchy",<br>  "message": "Category cannot be its own parent",<br>  "field": "parentCategoryId"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Business logic validation |
| TC_CAT_013C | Ki·ªÉm tra t·∫°o category v·ªõi parentCategoryId = 0 | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Zero Parent", "parentCategoryId": 0 } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Invalid parent category",<br>  "message": "Parent category ID must be a positive integer or null",<br>  "field": "parentCategoryId"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>ID validation |
| TC_CAT_014 | Ki·ªÉm tra t·∫°o category v·ªõi role User (kh√¥ng c√≥ quy·ªÅn) | G·ª≠i POST request ƒë·∫øn "/api/categories".<br>Header Authorization: Bearer &lt;user_token&gt;.<br>Body: { "name": "Unauthorized Category" } | - HTTP Status: 403 Forbidden<br>- Response body:<br>{<br>  "error": "Access denied",<br>  "message": "Only administrators can create categories"<br>} | User ƒë√£ ƒëƒÉng nh·∫≠p (user@techbox.com/user123)<br>JWT token h·ª£p l·ªá v·ªõi USER role only |

### **Function 6: C·∫≠p nh·∫≠t category (PUT /api/categories/{id})**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_015 | Ki·ªÉm tra c·∫≠p nh·∫≠t category th√†nh c√¥ng v·ªõi role Admin | G·ª≠i PUT request ƒë·∫øn "/api/categories/1".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Consumer Electronics" } | - HTTP Status: 200 OK<br>- Response body:<br>{<br>  "id": 1,<br>  "name": "Consumer Electronics",<br>  "parentCategoryId": null,<br>  "createdAt": "2025-09-30T10:00:00Z",<br>  "updatedAt": "2025-09-30T14:30:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Category Electronics (ID=1) t·ªìn t·∫°i<br>New name "Consumer Electronics" ch∆∞a t·ªìn t·∫°i |
| TC_CAT_016 | Ki·ªÉm tra c·∫≠p nh·∫≠t category kh√¥ng t·ªìn t·∫°i | G·ª≠i PUT request ƒë·∫øn "/api/categories/999999".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Non-existent Category" } | - HTTP Status: 404 Not Found<br>- Response body:<br>{<br>  "error": "Category not found",<br>  "message": "Category with ID 999999 does not exist"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>ID 999999 kh√¥ng t·ªìn t·∫°i |
| TC_CAT_017 | Ki·ªÉm tra c·∫≠p nh·∫≠t category v·ªõi t√™n tr√πng l·∫∑p | G·ª≠i PUT request ƒë·∫øn "/api/categories/1".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Fashion" } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Duplicate entry",<br>  "message": "Category name 'Fashion' already exists",<br>  "field": "name"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Category Electronics (ID=1), Fashion (ID=3) t·ªìn t·∫°i |
| TC_CAT_018 | Ki·ªÉm tra c·∫≠p nh·∫≠t category v·ªõi role User (kh√¥ng c√≥ quy·ªÅn) | G·ª≠i PUT request ƒë·∫øn "/api/categories/1".<br>Header Authorization: Bearer &lt;user_token&gt;.<br>Body: { "name": "Electronics Updated" } | - HTTP Status: 403 Forbidden<br>- Response body:<br>{<br>  "error": "Access denied",<br>  "message": "Only administrators can update categories"<br>} | User ƒë√£ ƒëƒÉng nh·∫≠p<br>Category Electronics (ID=1) t·ªìn t·∫°i |
| TC_CAT_019 | Ki·ªÉm tra c·∫≠p nh·∫≠t parent category th√†nh c√¥ng | G·ª≠i PUT request ƒë·∫øn "/api/categories/2".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Mobile Phones", "parentCategoryId": 3 } | - HTTP Status: 200 OK<br>- Response body:<br>{<br>  "id": 2,<br>  "name": "Mobile Phones",<br>  "parentCategoryId": 3,<br>  "createdAt": "2025-09-30T10:00:00Z",<br>  "updatedAt": "2025-09-30T14:45:00Z"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Category Smartphones (ID=2) v√† Fashion (ID=3) t·ªìn t·∫°i |
| TC_CAT_020 | Ki·ªÉm tra c·∫≠p nh·∫≠t category v·ªõi parent t·∫°o circular reference | G·ª≠i PUT request ƒë·∫øn "/api/categories/1".<br>Header Authorization: Bearer &lt;admin_token&gt;.<br>Body: { "name": "Electronics", "parentCategoryId": 2 } | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Invalid hierarchy",<br>  "message": "Cannot create circular reference: Electronics is already parent of Smartphones",<br>  "field": "parentCategoryId"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Electronics (ID=1) is parent of Smartphones (ID=2) |

### **Function 7: X√≥a category (DELETE /api/categories/{id})**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_021 | Ki·ªÉm tra x√≥a category th√†nh c√¥ng (soft delete) v·ªõi role Admin | G·ª≠i DELETE request ƒë·∫øn "/api/categories/4".<br>Header Authorization: Bearer &lt;admin_token&gt;. | - HTTP Status: 204 No Content | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Category Books (ID=4) t·ªìn t·∫°i v√† kh√¥ng c√≥ child categories ho·∫∑c products |
| TC_CAT_022 | Ki·ªÉm tra x√≥a category kh√¥ng t·ªìn t·∫°i | G·ª≠i DELETE request ƒë·∫øn "/api/categories/999999".<br>Header Authorization: Bearer &lt;admin_token&gt;. | - HTTP Status: 404 Not Found<br>- Response body:<br>{<br>  "error": "Category not found",<br>  "message": "Category with ID 999999 does not exist"<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>ID 999999 kh√¥ng t·ªìn t·∫°i |
| TC_CAT_023 | Ki·ªÉm tra x√≥a category c√≥ child categories | G·ª≠i DELETE request ƒë·∫øn "/api/categories/1".<br>Header Authorization: Bearer &lt;admin_token&gt;. | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Cannot delete category",<br>  "message": "Category has 2 child categories. Please reassign or delete child categories first.",<br>  "childCategories": [2, 4]<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Electronics (ID=1) c√≥ child categories: Smartphones (ID=2), Laptops (ID=4) |
| TC_CAT_024 | Ki·ªÉm tra x√≥a category ƒëang ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi products | G·ª≠i DELETE request ƒë·∫øn "/api/categories/2".<br>Header Authorization: Bearer &lt;admin_token&gt;. | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Cannot delete category",<br>  "message": "Category is being used by 5 products. Please reassign or delete products first.",<br>  "relatedProducts": [101, 102, 103, 104, 105]<br>} | Admin ƒë√£ ƒëƒÉng nh·∫≠p<br>Smartphones (ID=2) c√≥ products |
| TC_CAT_025 | Ki·ªÉm tra x√≥a category v·ªõi role User (kh√¥ng c√≥ quy·ªÅn) | G·ª≠i DELETE request ƒë·∫øn "/api/categories/4".<br>Header Authorization: Bearer &lt;user_token&gt;. | - HTTP Status: 403 Forbidden<br>- Response body:<br>{<br>  "error": "Access denied",<br>  "message": "Only administrators can delete categories"<br>} | User ƒë√£ ƒëƒÉng nh·∫≠p<br>Category Books (ID=4) t·ªìn t·∫°i |

### **Function 8: Ki·ªÉm tra t·ªìn t·∫°i category (GET /api/categories/exists)**

| Test Case ID | Test Case Description | Request Format | Expected Results | Pre-conditions |
|--------------|----------------------|----------------|-----------------|--------------| 
| TC_CAT_026 | Ki·ªÉm tra category t·ªìn t·∫°i v·ªõi t√™n h·ª£p l·ªá (Public access) | G·ª≠i GET request ƒë·∫øn "/api/categories/exists?name=Electronics". | - HTTP Status: 200 OK<br>- Response body:<br>{<br>  "exists": true,<br>  "categoryId": 1,<br>  "name": "Electronics"<br>} | Category "Electronics" t·ªìn t·∫°i (ID=1)<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_027 | Ki·ªÉm tra category kh√¥ng t·ªìn t·∫°i | G·ª≠i GET request ƒë·∫øn "/api/categories/exists?name=NonExistentCategory". | - HTTP Status: 200 OK<br>- Response body:<br>{<br>  "exists": false,<br>  "name": "NonExistentCategory"<br>} | Category "NonExistentCategory" kh√¥ng t·ªìn t·∫°i<br>**Kh√¥ng c·∫ßn authentication** |
| TC_CAT_028 | Ki·ªÉm tra v·ªõi parameter name r·ªóng | G·ª≠i GET request ƒë·∫øn "/api/categories/exists?name=". | - HTTP Status: 400 Bad Request<br>- Response body:<br>{<br>  "error": "Invalid parameter",<br>  "message": "Category name parameter is required",<br>  "field": "name"<br>} | **Kh√¥ng c·∫ßn authentication** |
| TC_CAT_029 | Ki·ªÉm tra case sensitivity trong t√™n category | G·ª≠i GET request ƒë·∫øn "/api/categories/exists?name=electronics". | - HTTP Status: 200 OK<br>- Response body:<br>{<br>  "exists": true,<br>  "categoryId": 1,<br>  "name": "Electronics",<br>  "searchedName": "electronics"<br>} | Category "Electronics" t·ªìn t·∫°i (case insensitive match)<br>**Kh√¥ng c·∫ßn authentication** |

---

## Summary

### **üìä Test Coverage Overview**

| Function | Test Cases | Coverage |
|----------|------------|----------|
| **GET /api/categories** | TC_CAT_001-002 | ‚úÖ List, Empty, Public Access |
| **GET /api/categories/{id}** | TC_CAT_003-005 | ‚úÖ Valid ID, Invalid ID, Not Found |
| **GET /api/categories/root** | TC_CAT_006-007 | ‚úÖ Root categories, Empty |
| **GET /api/categories/{parentId}/children** | TC_CAT_007A-007C | ‚úÖ Child categories, Empty, Invalid parent |
| **POST /api/categories** | TC_CAT_008-014 | ‚úÖ Success, Validation, Hierarchy, Security |
| **PUT /api/categories/{id}** | TC_CAT_015-020 | ‚úÖ Update, Validation, Hierarchy, Security |
| **DELETE /api/categories/{id}** | TC_CAT_021-025 | ‚úÖ Delete, Constraints, Hierarchy, Permissions |
| **GET /api/categories/exists** | TC_CAT_026-029 | ‚úÖ Exists Check, Parameters |

**Total Test Cases: 39**

### **üîê Security Test Coverage**

| Security Aspect | Test Cases | Status |
|------------------|------------|--------|
| **Authentication** | TC_CAT_014, 018, 025 | ‚úÖ Role-based access |
| **Input Validation** | TC_CAT_009-012D | ‚úÖ Comprehensive |
| **SQL Injection** | TC_CAT_012B | ‚úÖ Protected |
| **XSS Protection** | TC_CAT_012C, 011C | ‚úÖ Filtered |
| **Data Integrity** | TC_CAT_012, 012A | ‚úÖ Uniqueness |
| **Hierarchical Logic** | TC_CAT_013A-013C, 020, 023 | ‚úÖ Business rules |
| **Length Validation** | TC_CAT_010, 010A | ‚úÖ Min/Max limits |

### **üèóÔ∏è Hierarchical Features Coverage**

| Hierarchy Aspect | Test Cases | Status |
|------------------|------------|--------|
| **Parent-Child Creation** | TC_CAT_013, 013A | ‚úÖ Valid/Invalid parent |
| **Circular Reference** | TC_CAT_013B, 020 | ‚úÖ Prevention |
| **Root Categories** | TC_CAT_006-007 | ‚úÖ Listing |
| **Child Categories** | TC_CAT_007A-007C | ‚úÖ Listing by parent |
| **Cascade Constraints** | TC_CAT_023, 024 | ‚úÖ Delete restrictions |
| **Parent Updates** | TC_CAT_019, 020 | ‚úÖ Hierarchy validation |

### **üí° Implementation Notes**

1. **Hierarchical Validation**: Must prevent circular references and validate parent existence
2. **Cascade Rules**: Categories with children or products cannot be deleted
3. **Case Sensitivity**: Database queries for uniqueness check should be case-insensitive
4. **Input Sanitization**: Auto-trim whitespace, encode HTML entities
5. **Business Logic**: Root categories (parentCategoryId = null) vs child categories
6. **Error Messages**: Provide clear, security-conscious error messages
7. **Logging**: Log all security validation failures and hierarchy violations

---

## Authentication & Authorization Details

### **Login ƒë·ªÉ l·∫•y JWT Token**

G·ª≠i POST request ƒë·∫øn "/api/auth/login".
Body: 
```json
{
  "username": "admin@techbox.com",
  "password": "admin123"
}
```

Response:
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "username": "admin@techbox.com", 
    "role": "ADMIN"
  },
  "expiresIn": 3600
}
```

### **Role-based Access Control - Logic h·ª£p l√Ω cho E-commerce**

| Role | Permissions | API Access | Business Logic |
|------|-------------|-------------|----------------|
| **ADMIN** | Full management access | ‚úÖ GET, POST, PUT, DELETE /api/categories/* | Qu·∫£n l√Ω to√†n b·ªô danh m·ª•c |
| **MANAGER** | View only (for reporting) | ‚úÖ GET /api/categories/* <br> ‚ùå POST, PUT, DELETE | Xem ƒë·ªÉ b√°o c√°o, kh√¥ng thay ƒë·ªïi |
| **USER** | View for shopping | ‚úÖ GET /api/categories/* <br> ‚ùå POST, PUT, DELETE | Xem categories ƒë·ªÉ mua s·∫Øm |
| **ANONYMOUS** | Public view | ‚úÖ GET /api/categories/* <br> ‚ùå POST, PUT, DELETE | Kh√°ch v√£ng lai xem s·∫£n ph·∫©m |

**üí° Logic nghi·ªáp v·ª• h·ª£p l√Ω:**
- üõçÔ∏è **Xem categories**: Public access - kh√°ch h√†ng c·∫ßn th·∫•y categories ƒë·ªÉ navigate
- üîê **Qu·∫£n l√Ω categories**: Ch·ªâ Admin - v√¨ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn c·∫•u tr√∫c site
- üìä **Manager**: Ch·ªâ xem ƒë·ªÉ b√°o c√°o, kh√¥ng ƒë∆∞·ª£c thay ƒë·ªïi d·ªØ li·ªáu
- üèóÔ∏è **Hierarchical structure**: Critical cho navigation v√† SEO

**‚ö†Ô∏è C·∫ßn c·∫≠p nh·∫≠t SecurityConfig:**
```java
.requestMatchers(HttpMethod.GET, "/api/categories/**").permitAll()
.requestMatchers("/api/categories/**").hasRole("ADMIN")
```

### **Test Accounts**
```
Admin: admin@techbox.com / admin123
Manager: manager@techbox.com / manager123  
User: user@techbox.com / user123
```

### **Test Data Setup**
```sql
-- Root Categories
INSERT INTO categories (id, name, parent_category_id) VALUES 
(1, 'Electronics', NULL),
(3, 'Fashion', NULL);

-- Child Categories  
INSERT INTO categories (id, name, parent_category_id) VALUES
(2, 'Smartphones', 1),
(4, 'Laptops', 1);
```